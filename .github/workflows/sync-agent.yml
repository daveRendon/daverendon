name: "Run SociableKIT Sync every 3 days"

# This workflow runs a headless browser automation that logs in to the
# SociableKIT widget page and clicks the "Request sync" button.  It is
# scheduled using a cron expression that triggers every 3 days at
# midnight UTC.  You can also trigger it manually via the Actions tab.

on:
  schedule:
    # Every 3 days at 00:00 UTC (midnight)
    - cron: "0 0 */3 * *"
  workflow_dispatch: {}

jobs:
  sync_widget:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install selenium webdriver-manager

      - name: Run sync script
        run: |
          python .github/scripts/sync_sociablekit.py
        env:
          SOCIALKIT_EMAIL: ${{ secrets.SOCIALKIT_EMAIL }}
          SOCIALKIT_PASSWORD: ${{ secrets.SOCIALKIT_PASSWORD }}

# To use this workflow:
# 1. Commit sync_sociablekit.py to your repository (as provided in this project).
# 2. Define the secrets SOCIALKIT_EMAIL and SOCIALKIT_PASSWORD in your GitHub
#    repository settings. These will be passed to the script at runtime.
# 3. Optionally customize the cron schedule to suit your needs.